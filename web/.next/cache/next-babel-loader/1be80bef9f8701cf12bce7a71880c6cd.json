{"ast":null,"code":"let canvas;\nlet ctx;\nlet field;\nlet w, h;\nlet size;\nlet columns;\nlet rows;\nlet noiseZ;\n\nfunction setup() {\n  size = 20;\n  noiseZ = 0;\n  canvas = document.querySelector(\"#canvas\");\n  ctx = canvas.getContext(\"2d\");\n  reset();\n  window.addEventListener(\"resize\", reset);\n}\n\nfunction initField() {\n  field = new Array(columns);\n\n  for (let x = 0; x < columns; x++) {\n    field[x] = new Array(columns);\n\n    for (let y = 0; y < rows; y++) {\n      field[x][y] = [0, 0];\n    }\n  }\n}\n\nfunction calculateField() {\n  for (let x = 0; x < columns; x++) {\n    for (let y = 0; y < rows; y++) {\n      let angle = noise.simplex3(x / 80, y / 80, noiseZ) * Math.PI * 2;\n      let length = noise.simplex3(x / 100 + 40000, y / 100 + 40000, noiseZ);\n      field[x][y][0] = angle;\n      field[x][y][1] = length;\n    }\n  }\n}\n\nfunction reset() {\n  w = canvas.width = window.innerWidth;\n  h = canvas.height = window.innerHeight;\n  noise.seed(Math.random());\n  columns = Math.floor(w / size) + 1;\n  rows = Math.floor(h / size) + 1;\n  initField();\n}\n\nfunction draw() {\n  requestAnimationFrame(draw);\n  calculateField();\n  noiseZ += 0.004;\n  clear();\n  drawField();\n}\n\nfunction clear() {\n  ctx.fillStyle = \"black\";\n  ctx.fillRect(0, 0, w, h);\n}\n\nfunction drawField() {\n  for (let x = 0; x < columns; x++) {\n    for (let y = 0; y < rows; y++) {\n      let angle = field[x][y][0];\n      let length = field[x][y][1];\n      ctx.save();\n      ctx.translate(x * size, y * size);\n      ctx.rotate(angle);\n      ctx.strokeStyle = \"white\";\n      ctx.beginPath();\n      ctx.moveTo(0, 0);\n      ctx.lineTo(0, size * length);\n      ctx.stroke();\n      ctx.restore();\n    }\n  }\n}\n\nsetup();\ndraw();","map":null,"metadata":{},"sourceType":"script"}